<!--
  This Hugo shortcode adds support for Mermaid diagrams on pages where 'mermaid' is set to true in the front matter.
  To use, wrap your Mermaid diagram code within this shortcode without the leading and trailing "```".
  Ensure 'mermaid' is enabled in your page's front matter for the shortcode to process your diagram.
  If 'mermaid' is not enabled, an error message will prompt you to set it to true.
-->

{{ if .Page.Params.mermaid -}}
  <div class="mermaid{{ with .Get "class" }} {{ . }}{{ end }}">
    {{ $data := replaceRE "(^\\s+```)" "" .Inner -}}
    {{ replaceRE "(```\\s+$)" "" $data -}}
  </div>
{{ else -}}
  {{ errorf "Failed to process mermaid shortcode: %s. Set mermaid to true in page front matter." .Position }}
{{ end -}}
